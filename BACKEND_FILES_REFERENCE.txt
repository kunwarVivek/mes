BACKEND IMPLEMENTATION - QUICK FILE REFERENCE
==============================================

ROOT LOCATIONS:
- Backend app code: /home/user/mes/backend/app/
- Database schemas: /home/user/mes/backend/database/schema/
- Migrations: /home/user/mes/backend/migrations/versions/

KEY ENTRY POINTS:
1. /home/user/mes/backend/app/main.py - FastAPI application entry point
2. /home/user/mes/backend/app/core/config.py - Configuration settings
3. /home/user/mes/backend/app/core/database.py - Database connection & session management

AUTHENTICATION & MIDDLEWARE:
- /home/user/mes/backend/app/infrastructure/security/jwt_handler.py
- /home/user/mes/backend/app/infrastructure/security/dependencies.py
- /home/user/mes/backend/app/presentation/middleware/auth_middleware.py
- /home/user/mes/backend/app/presentation/middleware/request_id_middleware.py
- /home/user/mes/backend/app/presentation/middleware/rate_limit_middleware.py

API ROUTES (17+ endpoints):
- /home/user/mes/backend/app/presentation/api/v1/__init__.py (router aggregation)
- /home/user/mes/backend/app/presentation/api/v1/auth.py (login, refresh)
- /home/user/mes/backend/app/presentation/api/v1/users.py (user CRUD)
- /home/user/mes/backend/app/presentation/api/v1/bom.py (Bill of Materials)
- /home/user/mes/backend/app/presentation/api/v1/branding.py (white-label)
- /home/user/mes/backend/app/presentation/api/v1/custom_fields.py
- /home/user/mes/backend/app/presentation/api/v1/materials.py
- /home/user/mes/backend/app/presentation/api/v1/machines.py
- /home/user/mes/backend/app/presentation/api/v1/production_logs.py
- /home/user/mes/backend/app/presentation/api/v1/shifts.py
- /home/user/mes/backend/app/presentation/api/v1/maintenance.py
- /home/user/mes/backend/app/presentation/api/v1/quality.py
- /home/user/mes/backend/app/presentation/api/v1/workflows.py
- /home/user/mes/backend/app/presentation/api/v1/reporting.py
- /home/user/mes/backend/app/presentation/api/v1/logistics.py
- /home/user/mes/backend/app/presentation/api/v1/project_management.py
- /home/user/mes/backend/app/presentation/api/v1/infrastructure.py

DATA TRANSFER OBJECTS (DTOs) - 24 files:
/home/user/mes/backend/app/application/dtos/ - all *_dto.py files

USE CASES:
- /home/user/mes/backend/app/application/use_cases/user/ (create, get, update, delete)
- /home/user/mes/backend/app/application/use_cases/auth/ (login, refresh)

BUSINESS SERVICES (20+ files):
/home/user/mes/backend/app/application/services/ - all *_service.py files

DOMAIN LAYER (Business Logic):
- /home/user/mes/backend/app/domain/entities/ - 25 business entity files
- /home/user/mes/backend/app/domain/services/ - 8 domain service files
- /home/user/mes/backend/app/domain/repositories/ - repository interfaces
- /home/user/mes/backend/app/domain/value_objects/ - email.py, username.py
- /home/user/mes/backend/app/domain/exceptions/domain_exception.py

ORM MODELS (30 SQLAlchemy models):
/home/user/mes/backend/app/models/ - all model files including:
- user.py, organization.py, plant.py, department.py
- material.py, machine.py, shift.py, maintenance.py
- production_log.py, work_order.py, lane.py, bom.py
- quality.py, project.py, workflow.py, custom_field.py
- branding.py, logistics.py, reporting.py, traceability.py
- And 12+ more specialized models

DATA PERSISTENCE:
- /home/user/mes/backend/app/infrastructure/persistence/models.py
- /home/user/mes/backend/app/infrastructure/persistence/user_repository_impl.py
- /home/user/mes/backend/app/infrastructure/persistence/mappers/user_mapper.py
- /home/user/mes/backend/app/infrastructure/repositories/ (22+ repository implementations)

DATABASE & RLS:
- /home/user/mes/backend/app/infrastructure/database/rls.py (Row-Level Security)

INFRASTRUCTURE SERVICES:
Email:
- /home/user/mes/backend/app/infrastructure/email/config.py
- /home/user/mes/backend/app/infrastructure/email/templates/

Storage (MinIO):
- /home/user/mes/backend/app/infrastructure/storage/minio_client.py
- /home/user/mes/backend/app/infrastructure/storage/barcode_storage_service.py

Messaging:
- /home/user/mes/backend/app/infrastructure/messaging/pgmq_client.py
- /home/user/mes/backend/app/infrastructure/messaging/pgmq_tasks.py

Search:
- /home/user/mes/backend/app/infrastructure/search/pg_search_service.py
- /home/user/mes/backend/app/infrastructure/search/search_config.py

Tasks:
- /home/user/mes/backend/app/infrastructure/tasks/celery_app.py
- /home/user/mes/backend/app/infrastructure/tasks/user_tasks.py

SAP Integration:
- /home/user/mes/backend/app/infrastructure/adapters/sap/sap_client.py
- /home/user/mes/backend/app/infrastructure/adapters/sap/material_adapter.py
- /home/user/mes/backend/app/infrastructure/adapters/sap/inventory_adapter.py
- /home/user/mes/backend/app/infrastructure/adapters/sap/costing_adapter.py
- /home/user/mes/backend/app/infrastructure/adapters/sap/config.py

DATABASE SCHEMAS:
- /home/user/mes/backend/database/schema/00_extensions.sql
- /home/user/mes/backend/database/schema/01_core.sql
- /home/user/mes/backend/database/schema/init_schema.sql

MIGRATIONS:
- /home/user/mes/backend/migrations/env.py (Alembic config)
- /home/user/mes/backend/migrations/versions/001_initial_schema.py

CONFIGURATION FILES:
- /home/user/mes/backend/requirements.txt (Python dependencies)
- /home/user/mes/backend/alembic.ini (Alembic migration config)
- /home/user/mes/backend/Dockerfile (Docker container)
- /home/user/mes/backend/.env.example (Example environment variables)

DOCUMENTATION:
- /home/user/mes/backend/BOM_API_QUICK_REFERENCE.md
- /home/user/mes/backend/LANE_SCHEDULING_QUICK_REFERENCE.md
- /home/user/mes/backend/MAINTENANCE_QUICK_REFERENCE.md
- /home/user/mes/backend/JWT_TENANT_CONTEXT_USAGE_GUIDE.md

STATISTICS:
- Total Python files: 240+
- Total models: 30 SQLAlchemy ORM models
- Total API routers: 17+
- Model code: 6,312+ lines
- Database tables covered: 28+ with 53+ RLS policies
- Email providers supported: 3 (SMTP, SendGrid, AWS SES)

ARCHITECTURE LAYERS:
1. Presentation (API, Middleware) - /app/presentation/
2. Application (DTOs, Use Cases, Services) - /app/application/
3. Domain (Entities, Services, Repositories) - /app/domain/
4. Infrastructure (Adapters, Persistence, External Services) - /app/infrastructure/
5. Core (Configuration, Database) - /app/core/

TECHNOLOGY STACK:
- FastAPI 0.104.1
- SQLAlchemy 2.0.23
- PostgreSQL + TimescaleDB, PGMQ, pg_search, pg_duckdb, pg_cron
- JWT authentication
- MinIO (S3-compatible storage)
- Celery (async tasks)
- Casbin (RBAC)
- Alembic (database migrations)

